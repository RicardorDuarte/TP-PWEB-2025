@page "/"

<PageTitle>Home</PageTitle>

<CategoriasSliderComponent OnCategorySelected="UpdateProducts" />
<ProdutosFilterComponent Produtos="@produtos" OnFiltroSelected="ApplyFilter" />
<ProductsSliderComponent Produtos="@produtos" />
<SuggestionComponent Produtos="@produtos" />

@code {

    [Inject]
    public IApiServices _apiServices { get; set; }

    private List<Produto>? produtos = new List<Produto>();
    private int? currentCategoryId = null;

    protected override async Task OnInitializedAsync()
    {
        produtos = await _apiServices.GetProdutos("todos");
    }

    private async Task UpdateProducts(int categoryId)
    {
        currentCategoryId = categoryId;
        produtos = await _apiServices.GetProdutos("categoria", categoryId);
        StateHasChanged();
    }

    private async Task ApplyFilter(string filterType)
    {
        produtos = await _apiServices.GetProdutos(filterType, currentCategoryId);
        StateHasChanged();
    }
}
